# Проект "Бар-да-бар" - Сайт кафе и развлекательного центра

Современный веб-сайт для кафе "Бар-да-бар" с адаптивным дизайном, интерактивными элементами и системой управления контентом.

## Структура проекта

```
cafe_bardabar_v2/
├── next-landing/       # Современный Next.js лендинг
├── legacy-landing/     # Старый HTML/CSS/JS лендинг
├── backend/            # Централизованный Express.js бэкенд
├── strapi-cms/         # Strapi CMS для управления контентом
├── shared/             # Общие ресурсы и утилиты
├── database/           # Настройки и схемы БД
├── memory-bank/        # Документация проекта
├── docker-compose.yml  # Конфигурация Docker для разработки
└── ПЛАН_РАБОТ.md       # Детальный план реализации проекта
```

## Технологии

### Frontend
- **Next.js 14+** - React фреймворк с поддержкой SSR, SSG и ISR
- **TypeScript** - Типизированный JavaScript для надежного кода
- **Tailwind CSS** - Утилитарный CSS фреймворк
- **React** - Библиотека для создания пользовательских интерфейсов

### Backend
- **Express.js** - Веб-фреймворк для Node.js
- **Strapi** - Headless CMS для управления контентом
- **Node.js** - Среда выполнения JavaScript на сервере

### База данных
- **PostgreSQL** - Реляционная база данных

### Инструменты разработки
- **Docker** - Контейнеризация для разработки и деплоя
- **ESLint** - Статический анализ кода
- **Prettier** - Форматирование кода

## Основные функции

- **Просмотр меню** с категориями (бургеры, закуски, напитки и т.д.)
- **Афиша мероприятий** с фильтрацией по датам
- **Система бронирования столиков** с интеграцией с Telegram
- **Галерея фотографий** с оптимизацией изображений
- **Страница команды** с информацией о сотрудниках
- **Система отзывов** с возможностью модерации
- **Контактная информация** с интеграцией карт

## Установка и запуск

### Требования
- Node.js 18.x или выше
- npm 9.x или выше
- Docker и Docker Compose (опционально)

### Быстрый старт

1. **Клонирование репозитория:**
```bash
git clone https://github.com/your-username/cafe-bardabar-v2.git
cd cafe-bardabar-v2
```

2. **Установка зависимостей:**
```bash
npm install
```

3. **Запуск в режиме разработки:**
```bash
npm run dev
```

Это запустит:
- Backend на порту 3001
- Next.js на порту 3000 (через прокси)
- Strapi CMS на порту 1337

### Запуск с Docker

```bash
docker-compose up -d
```

## Доступные URL

- **http://localhost:3001/** - Главная (выбор между лендингами)
- **http://localhost:3001/legacy** - Legacy лендинг
- **http://localhost:3001/next** - Next.js лендинг
- **http://localhost:3001/api** - API endpoints
- **http://localhost:1337/admin** - Strapi CMS админ-панель

### Тестовые инструменты

- **http://localhost:3001/test-telegram** - Тестирование Telegram-уведомлений

## Тестовые данные

Для заполнения CMS тестовыми данными:

```bash
cd strapi-cms
npm run develop
```

При первом запуске Strapi автоматически создаст тестовые данные:
- Категории меню и блюда
- События и мероприятия
- Отзывы посетителей
- Информация о команде

## Документация

Подробная документация доступна в директории `memory-bank/`:
- `projectbrief.md` - Общая информация о проекте
- `productContext.md` - Продуктовый контекст
- `systemPatterns.md` - Системная архитектура и паттерны
- `techContext.md` - Технологический контекст
- `activeContext.md` - Текущий фокус работы
- `progress.md` - Статус разработки

## Оптимизации кодовой базы

### Выполненные оптимизации

#### Унификация подключения к базе данных

В рамках оптимизации кодовой базы были выполнены следующие изменения:

1. Удален неиспользуемый файл `backend/src/config/database.js`
2. Обновлен файл `backend/src/db/connection.ts` для использования `../config/env.js` вместо прямого доступа к `process.env`
3. Улучшена функция `getClient()` в `connection.ts` для более детального логирования запросов
4. Добавлены улучшенные сообщения при graceful shutdown
5. Создан тестовый скрипт `scripts/test-db-connection.js` для проверки подключения к базе данных

Все импорты в проекте теперь используют единый файл подключения к базе данных `backend/src/db/connection.ts`.

Дополнительные рекомендации по оптимизации кодовой базы можно найти в файле `РЕКОМЕНДАЦИИ.md` в корне проекта.

## План работ

Детальный план разработки проекта доступен в файле `ПЛАН_РАБОТ.md`.

## Лицензия

MIT
